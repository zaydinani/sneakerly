!function(h){h(window).on("elementor/frontend/init",()=>{class e extends elementorModules.frontend.handlers.Base{getDefaultSettings(){var e=this.getElementSettings();return{selectors:{form:".pp-registration-form"},min_pass_length:this.$element.find(".pp-registration-form").data("password-length"),pws_meter:"yes"===e.enable_pws_meter,i18n:{messages:{error:{invalid_username:ppRegistration.invalid_username,username_exists:ppRegistration.username_exists,empty_email:ppRegistration.empty_email,invalid_email:ppRegistration.invalid_email,email_exists:ppRegistration.email_exists,password:ppRegistration.password,password_length:ppRegistration.password_length,password_mismatch:ppRegistration.password_mismatch,invalid_url:ppRegistration.invalid_url,recaptcha_php_ver:ppRegistration.recaptcha_php_ver,recaptcha_missing_key:ppRegistration.recaptcha_missing_key},success:e.success_message},pw_toggle_text:{show:ppRegistration.show_password,hide:ppRegistration.hide_password}},ajaxurl:ppRegistration.ajax_url}}getDefaultElements(){var e=this.getSettings("selectors");return{$form:this.$element.find(e.form)}}bindEvents(){var e;this.elements.$form.length<1||(e=this.getSettings(),this.initFields(),this.bindErrorCodes(),0<this.fields.user_pass.find(".pp-rf-toggle-pw").length&&this.fields.user_pass.find(".pp-rf-toggle-pw").on("click",h.proxy(this._passwordToggle,this)),e.pws_meter&&"undefined"!=typeof wp.passwordStrength&&this.fields.user_pass.control.on("input",h.proxy(this._beginPwsMeter,this)),this.$element.find(".pp-button").on("click",h.proxy(this.submit,this)),this.initReCaptcha())}initReCaptcha(){var e=this.$element.find(".pp-grecaptcha");elementorFrontend.isEditMode()&&undefined==e.attr("data-widgetid")&&onLoadPPReCaptcha()}initFields(){var e=this.elements.$form;this.fields={user_login:e.find('.pp-rf-field[data-field-type="user_login"]'),user_email:e.find('.pp-rf-field[data-field-type="user_email"]'),user_pass:e.find('.pp-rf-field[data-field-type="user_pass"]'),confirm_user_pass:e.find('.pp-rf-field[data-field-type="confirm_user_pass"]'),user_url:e.find('.pp-rf-field[data-field-type="user_url"]'),first_name:e.find('.pp-rf-field[data-field-type="first_name"]'),last_name:e.find('.pp-rf-field[data-field-type="last_name"]'),consent:e.find('.pp-rf-field[data-field-type="consent"]'),recaptcha:e.find('.pp-rf-field[data-field-type="recaptcha"]')},Object.keys(this.fields).forEach(h.proxy(function(e){var s;void 0!==e&&0<(s=this.fields[e].find('.pp-rf-control[name="'+e+'"]')).length&&(this.fields[e].control=s)},this))}bindErrorCodes(){this.errorCodes={empty_email:"user_email",invalid_email:"user_email",email_exists:"user_email",username_wp_error:"user_login",invalid_username:"user_login",username_exists:"user_login",password:"user_pass",password_mismatch:"confirm_user_pass",invalid_url:"user_url",recaptcha_php_ver:"recaptcha",recaptcha_missing_key:"recaptcha"}}getFieldByCode(e){return"undefined"!=typeof this.errorCodes[e]&&(e=this.errorCodes[e],this.fields[e])}getFormData(){var e=new FormData(this.$element.find(".pp-registration-form")[0]);return e.append("referrer",location.toString()),e}submit(e){var i,s,r=this.getSettings(),t=(this.isValid=!0,this.messages=r.i18n.messages,this.elements.$form),a=this.$element.find(".pp-button"),n=this.getFormData(),d=this.$element.find(".pp-grecaptcha"),p=d.data("pp-grecaptcha-response"),l=r.ajaxurl,o=t.closest(".pp-rf-wrap").data("post-id"),f=(t.data("template-id"),t.data("template-node-id"),t.closest(".elementor-widget-pp-registration-form").data("id"));e.preventDefault(),a.hasClass("pp-disabled")||(t.find(".pp-rf-field").removeClass("pp-rf-field-error"),i=this,t.find(".pp-rf-field.elementor-mark-required").each(function(){var e=h(this),s=e.data("field-type"),s=h(this).find('[name="'+s+'"]');0<s.length&&("checkbox"===s.attr("type")||"radio"===s.attr("type")?s.is(":checked")?i.fieldHasError(e)&&i.removeErrorClass(e):(i.isValid=!1,i.addErrorClass(e)):s.val()&&""!==s.val()?i.fieldHasError(e)&&i.removeErrorClass(e):(i.isValid=!1,i.addErrorClass(e)))}),0<this.fields.user_email.length&&(""===(e=this.fields.user_email.find('input[type="email"]')).val()?(this.isValid=!1,this.addErrorClass(this.fields.user_email)):/\S+@\S+\.\S+/.test(e.val())?this.fieldHasError(this.fields.user_email)&&this.removeErrorClass(this.fields.user_email):(this.isValid=!1,this.removeErrorClass(this.fields.user_email),this.addInlineError(this.fields.user_email,r.messages.error.invalid_email))),0<this.fields.user_pass.length&&""!==(s=this.fields.user_pass.control).val()&&s.val().length<r.min_pass_length&&(this.isValid=!1,this.addInlineError(this.fields.user_pass,this.messages.error.password_length)),0<this.fields.confirm_user_pass.length&&(e=this.fields.confirm_user_pass.find('input[name="confirm_user_pass"]').val(),s=this.fields.user_pass.find('input[name="user_pass"]').val(),""!==e)&&btoa(e)!==btoa(s)&&(this.isValid=!1,this.addInlineError(this.fields.confirm_user_pass,r.messages.error.password_mismatch)),0<d.length&&this.isValid&&(void 0===p||!1===p?"normal"==d.data("validate")?(this.isValid=!1,this.addErrorClass(this.fields.recaptcha)):"invisible"==d.data("validate")&&grecaptcha.execute(d.data("widgetid")):this.removeErrorClass(this.fields.recaptcha)),this.isValid&&(a.addClass("pp-disabled"),0<d.length&&n.append("recaptcha",!0),p&&n.append("recaptcha_response",p),n.append("node_id",f),n.append("action","ppe_register_user"),n.append("security",t.data("nonce")),n.append("post_id",o),h.ajax({url:l,type:"POST",dataType:"json",data:n,processData:!1,contentType:!1,success:h.proxy(this.submitComplete,this),error:this.onError})))}submitComplete(e){var s,i,r=this.$element.find(" .pp-rf-success-none");if("undefined"==typeof e.success||!0!==e.success)return h(this.$element).find(".pp-button").removeClass("pp-disabled"),"undefined"!=typeof e.data.message?(i=e.data,s=this.getFieldByCode(i.code),i="undefined"!=typeof this.messages.error[i.code]?this.messages.error[i.code]:i.message,s&&0<s.length?this.addInlineError(s,i):(this.$element.find(" .pp-rf-failed-error").html(i),this.$element.find(" .pp-rf-failed-error").fadeIn())):this.$element.find(" .pp-rf-failed-error").fadeIn(),!1;this.$element.find(" .pp-rf-failed-error").fadeOut(),"yes"!==e.data.auto_login||"undefined"!=typeof e.data.redirect_url&&""!==e.data.redirect_url?"undefined"!=typeof e.data.redirect_url?window.location.href=e.data.redirect_url:(0<r.length?r:(this.$element.find(".pp-registration-form").hide(),this.$element.find(".pp-after-submit-action.pp-rf-success"))).fadeIn():window.location.reload()}onError(e,s){console.log(s)}addInlineError(e,s){e.find(".pp-rf-error-inline").remove(),e.addClass("pp-rf-field-error").append('<span class="pp-rf-error-inline">'+s+"</span>")}addErrorClass(e){e.addClass("pp-rf-validation-error")}removeErrorClass(e){e.removeClass("pp-rf-validation-error")}fieldHasError(e){return e.hasClass("pp-rf-validation-error")}}elementorFrontend.elementsHandler.attachHandler("pp-registration-form",e)})}(jQuery);