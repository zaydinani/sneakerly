!function(l){window.onLoadPPReCaptcha=function(){var n,e=l(".pp-grecaptcha");0<e.length&&e.each(function(e){var t=l(this),a=t.attr("data-widgetid"),i=l(this).attr("id");typeof a!=typeof undefined&&!1!==a||(t.attr("id",i),n=grecaptcha.render(i,{sitekey:t.data("sitekey"),theme:t.data("theme"),size:t.data("validate"),callback:function(e){""!=e&&(t.attr("data-pp-grecaptcha-response",e),"invisible"==t.data("validate"))&&t.closest(".elementor-widget").find(".pp-submit-button").trigger("click")}}),t.attr("data-widgetid",n))})};(PPLoginForm=function(e,t,a){this.node=e,this.id=a.id,this.messages=a.messages,this.settings=a,this.elementSettings=t,this.i18n=a.i18n,this.form=l(this.node).find(".pp-login-form"),this.passwordField=this.form.find(".pp-lf-field-pw-toggle"),this._init()}).prototype={settings:{},_init:function(){0<this.passwordField.find(".pp-lf-toggle-pw").length&&this.passwordField.find(".pp-lf-toggle-pw").on("click",l.proxy(this._passwordToggle,this)),this.settings.facebook_login&&this._initFacebookLogin(),0<this.node.find("#pp-form-"+this.id).length&&"yes"===this.elementSettings.enable_ajax&&this.node.find("#pp-form-"+this.id).on("submit",l.proxy(this._loginFormSubmit,this)),0<this.node.find(".pp-login-form--lost-pass").length&&this.node.find(".pp-login-form--lost-pass").on("submit",l.proxy(this._lostPassFormSubmit,this)),0<this.node.find(".pp-login-form--reset-pass").length&&this.node.find(".pp-login-form--reset-pass").on("submit",l.proxy(this._resetPassFormSubmit,this)),this.settings.enable_recaptcha&&this._initReCaptcha()},_passwordToggle:function(){var e=this.passwordField;"text"===(pwFieldControl=e.find('.elementor-field[name="pwd"]')).attr("type")?(pwFieldControl.attr("type","password"),e.find(".pp-lf-toggle-pw").attr("aria-label",this.i18n.pw_toggle_text.show).find("span").removeClass("fa-eye-slash").addClass("fa-eye")):(pwFieldControl.attr("type","text"),e.find(".pp-lf-toggle-pw").attr("aria-label",this.i18n.pw_toggle_text.hide).find("span").removeClass("fa-eye").addClass("fa-eye-slash"))},_initReCaptcha:function(){var e=this.node.find(".pp-grecaptcha");elementorFrontend.isEditMode()&&undefined==e.attr("data-widgetid")&&onLoadPPReCaptcha()},_initFacebookLogin:function(){""!==this.settings.facebook_app_id&&0<this.node.find(".pp-fb-login-button").length&&(this._initFacebookSDK(),this.node.find(".pp-fb-login-button").on("click",l.proxy(this._facebookLoginClick,this)))},_initFacebookSDK:function(){var e=this,t=(0===l("#fb-root").length&&l("body").prepend('<div id="fb-root"></div>'),document),a="script",i="facebook-jssdk",n=t.getElementsByTagName(a)[0];t.getElementById(i)||((a=t.createElement(a)).id=i,a.src="//connect.facebook.net/en_US/sdk.js",n.parentNode.insertBefore(a,n),window.fbAsyncInit=function(){FB.init({appId:e.settings.facebook_app_id,cookie:!0,xfbml:!0,version:"v2.12"})})},_facebookLoginClick:function(){var a=this,e=this.node.find(".pp-login-form").find('input[name="redirect_to"]'),i={action:"pp_lf_process_social_login",provider:"facebook",page_url:a.settings.page_url,nonce:a._getNonce()};0<e.length&&""!==e.val()&&(i.redirect=e.val()),this._disableForm(),FB.login(function(e){"connected"===e.status?FB.api("/me",{fields:"id, email, name, first_name, last_name"},function(e){var t=FB.getAuthResponse();i.user_data=e,i.auth_response=t,a._ajax(i,function(e){e.success?e.data.redirect_url?window.location.href=e.data.redirect_url:window.location.reload():(console.error(e.data),a._enableForm())})}):(e.authResponse&&console.error("PP Login Form: Unable to connect Facebook account."),a._enableForm())},{scope:"email",return_scopes:!0})},_loginFormSubmit:function(e){e.preventDefault();var a=l(e.target),e=a.find('input[name="log"]'),t=a.find('input[name="pwd"]'),i=a.find('input[name="rememberme"]'),n=a.find('input[name="redirect_to"]'),s=a.find(".pp-grecaptcha"),o=s.data("pp-grecaptcha-response"),r=this;if(e.parent().find(".pp-lf-error").remove(),t.parent().find(".pp-lf-error").remove(),s.parent().find(".pp-lf-error").remove(),""===e.val().trim())l('<span class="pp-lf-error">').insertAfter(e).html(this.messages.empty_username);else if(""===t.val())l('<span class="pp-lf-error">').insertAfter(t).html(this.messages.empty_password);else{if(0<s.length&&(void 0===o||!1===o)){if("normal"==s.data("validate"))return void l('<span class="pp-lf-error">').insertAfter(s).html(this.messages.empty_recaptcha);"invisible"==s.data("validate")&&grecaptcha.execute(s.data("widgetid"))}var p=new FormData(a[0]);p.append("action","ppe_lf_process_login"),p.append("page_url",this.settings.page_url),p.append("username",e.val()),p.append("password",t.val()),0<n.length&&""!==n.val()&&p.append("redirect",n.val()),0<i.length&&i.is(":checked")&&p.append("remember","1"),0<s.length&&(p.append("recaptcha",!0),p.append("recaptcha_validate",s.data("validate")),p.append("recaptcha_validate_type",s.data("validate-type"))),o&&p.append("recaptcha_response",o),this._disableForm(),this._ajax(p,function(e){var t;e.success?!e.data.redirect_url||(t=location.protocol+"//"+location.host,(""===e.data.redirect_url.split(t)[0]?e.data.redirect_url.split(t)[1]:e.data.redirect_url.split(t)[0])===location.href.split(t)[1])?window.location.reload():window.location.href=e.data.redirect_url:(r._enableForm(),a.find(".pp-lf-error").remove(),l('<span class="pp-lf-error">').appendTo(a).html(e.data))})}},_lostPassFormSubmit:function(e){e.preventDefault();var t,a=l(e.target),i=a.find('input[name="user_login"]'),e=a.find('input[name="lost_redirect_to"]'),n=a.find('input[name="is_lost_redirect"]'),s=this;i.parent().find(".pp-lf-error").remove(),""===i.val().trim()?l('<span class="pp-lf-error">').insertAfter(i).html(this.messages.empty_username):((t=new FormData(a[0])).append("action","pp_lf_process_lost_pass"),t.append("page_url",this.settings.page_url),0<e.length&&""!==e.val()&&t.append("redirect",e.val()),this._disableForm(),this._ajax(t,function(e){var t;s._enableForm(),e.success?"0"===n.val()?(l('<p class="pp-lf-success">').insertAfter(a).html(s.messages.email_sent),a.hide()):!e.data.redirect_url||(t=location.protocol+"//"+location.host,(""===e.data.redirect_url.split(t)[0]?e.data.redirect_url.split(t)[1]:e.data.redirect_url.split(t)[0])===location.href.split(t)[1])?window.location.reload():(window.location.href=e.data.redirect_url,l('<p class="pp-lf-success">').insertAfter(a).html(s.messages.email_sent),a.hide()):(i.parent().find(".pp-lf-error").remove(),l('<span class="pp-lf-error">').insertAfter(i).html(e.data))}))},_resetPassFormSubmit:function(e){e.preventDefault();var t=l(e.target),e=t.find('input[name="password_1"]'),a=t.find('input[name="password_2"]'),i=this;e.parent().find(".pp-lf-error").remove(),a.parent().find(".pp-lf-error").remove(),""===e.val()?l('<span class="pp-lf-error">').insertAfter(e).html(this.messages.empty_password_1):""===a.val()?l('<span class="pp-lf-error">').insertAfter(a).html(this.messages.empty_password_2):((e=new FormData(t[0])).append("action","pp_lf_process_reset_pass"),e.append("page_url",this.settings.page_url),this._disableForm(),this._ajax(e,function(e){i._enableForm(),e.success?(l('<p class="pp-lf-success">').insertAfter(t).html(i.messages.reset_success),t.hide()):(t.find(".pp-lf-error").remove(),l('<span class="pp-lf-error">').appendTo(t).html(e.data))}))},_enableForm:function(){this.node.find(".pp-login-form-wrap").removeClass("pp-event-disabled")},_disableForm:function(){this.node.find(".pp-login-form-wrap").addClass("pp-event-disabled")},_getNonce:function(){return this.node.find('.pp-login-form input[name="ppe-lf-login-nonce"]').val()},_ajax:function(e,t){var a={type:"POST",url:ppLogin.ajax_url,data:e,dataType:"json",success:function(e){"function"==typeof t&&t(e)},error:function(e,t){console.log(t)}};"undefined"==typeof e.provider&&(a.processData=!1,a.contentType=!1),l.ajax(a)}},PPGoogleLoginEndpoint=function(e,t){console.log(PPLoginForm.gtheme)}}(jQuery);